<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>简单</title>
    <meta http-equiv="Content-Type" content="text/html;charset=gb2312">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <script src="scripts/japp.js" type="text/javascript"></script>
    <script src="jbarextent.js" type="text/javascript"></script>

	<style> BODY { FONT-FAMILY: "Verdana"; FONT-SIZE: 12px; SCROLLBAR-HIGHLIGHT-COLOR: #f5f9ff; SCROLLBAR-SHADOW-COLOR: #828282; SCROLLBAR-3DLIGHT-COLOR: #828282; SCROLLBAR-ARROW-COLOR: #797979; SCROLLBAR-TRACK-COLOR: #ffffff; SCROLLBAR-FACE-COLOR: #66b7ef; SCROLLBAR-DARKSHADOW-COLOR: #ffffff }
	</style>

</head>
<body onload="window_onload();">
       <DIV style='position:absolute;border:0px solid #ff3900; left:10px;top:45px;'>
        &nbsp;服务器: <input type="text" id="mainIP" value="192.168.2.136"size="12"  />
        集团号: <input type="text" id="vccID" size="12" value="100004"  /> 		
		工号: <input type="text" id="agentID" value="6301" size="12"  />
		sip端口: <input type="text" id="sipPort" value="5060" size="12"  />
        <input id='btnInitial' type="button" onclick='funInitial();'  value="初始化" title="执行方法:Initial()" />
        <input id='btnUnInitial' type="button" onclick='application.oJVccBar.UnInitial();' value="注销" title="执行方法:UnInitial()" />
	   <input id='btnInitial' type="button" onclick='InitialMonitor();'  value="初始化监控" title="执行方法:InitialMonitor()" />
        <input id='btnShow' type="button" onclick='displayM(1);' value="显示" title="执行方法:displayM(1)" />
        <input id='btnUnShow' type="button" onclick='displayM(0);' value="隐藏" title="执行方法:displayM(0)" />
		</DIV>
		<DIV id ="divInput" style='position:absolute;border:0px solid #000000; left:10px;top:75px; display:none'>	
		    目标参数:
		    <INPUT type="text" id="DestNum" NAME="DestNum" size="22" title="变量名称:DestNum"><br>
		    附加参数:
		    <INPUT type="text" id="DestNum2" NAME="DestNum2"  size="22"  title="变量名称:DestNum2" >
		</DIV>

	    <div id ="divMonitor" style="position:absolute;border:0px solid #ff3900;left:240px;top:75px; display:none"  >
			<input id="btnInitialState" onclick="application.oJMonitor.InitialState();" type="button" value="InitialState"  title="执行方法:InitialState();" >
			<input id="btnAgentQuery" onclick="application.oJMonitor.AgentQuery(DestNum.value,parseInt(DestNum2.value));" type="button" value="AgentQuery"  title="执行方法:AgentQuery(DestNum.value,parseInt(DestNum2.value));" >
			<input id="btnTelQuery" onclick="application.oJMonitor.TelQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="TelQuery" title="执行方法:TelQuery(DestNum.value,parseInt(DestNum2.value));" >
			<input id="btnIvrQuery" onclick="application.oJMonitor.IvrQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="IvrQuery" title="执行方法:IvrQuery(DestNum.value,parseInt(DestNum2.value));" >
			<input id="btnServiceQuery" onclick="application.oJMonitor.ServiceQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="ServiceQuery" title="执行方法:ServiceQuery(DestNum.value,parseInt(DestNum2.value));" >
			<input id="btnTaskQuery" onclick="application.oJMonitor.TaskQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="TaskQuery" title="执行方法:TaskQuery(DestNum.value,parseInt(DestNum2.value));" >
			<input id="btnCallReportQuery" onclick="application.oJMonitor.CallReportQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="CallReportQuery" title="执行方法:CallReportQuery(DestNum.value,parseInt(DestNum2.value));" >
			<br>
			<input id="btnGetTaskSummary" onclick="application.oJMonitor.GetTaskSummary(DestNum.value,DestNum2.value);" type="button"  value="GetTaskSummary" title="执行方法:GetTaskSummary(DestNum.value,DestNum2.value);" >
			<input id="btnQueryMonitorSumInfo" onclick="application.oJMonitor.QueryMonitorSumInfo(DestNum.value,DestNum2.value);" type="button" value="查询指定参数的统计信息" title="执行:QueryMonitorSumInfo(DestNum.value,DestNum2.value);" >
			<input id="btnStartNotification" onclick="application.oJMonitor.StartNotification(DestNum.value,DestNum2.value,'');" type="button" value="StartNotification"  title="执行方法:StartNotification(DestNum.value,DestNum2.value,'');" >
			<input id="btnEndNotification" onclick="application.oJMonitor.EndNotification(DestNum.value);" type="button" value="EndNotification" title="执行方法:EndNotification(DestNum.value);" >
		</div>			
        <DIV id="divTextInfo" style='position:absolute;border:0px solid #00ff00; left:10px;top:95px;'>	
		<TEXTAREA id="TextareaInfo" name="TextareaInfo" rows="33" cols="160" value="" style="overflow:auto;font-family:verdana;font-size:12px"></TEXTAREA>
		</DIV>

</body>
</html>
 <script type="text/javascript">   
    var _display = 1;
	function window_onload()
	{
        applicationLoad(10,10,900,36,showStyleAUTTO,"",setVccBarEvent2);
	}
	
	function setVccBarEvent2()
	{
		var param = "192.168.2.125|100000|1010|5066";
		param = "121.9.210.99|300300|3003|5040";
		param = "111.204.26.22|100001|2000|5066";
		param = "192.168.2.136|100005|6602|5066";
		//param = "192.168.2.176|999998|9999|5066";
		//param = "120.26.107.156|000002|0105|5066";

        var oParam = param.split("|"); 
        mainIP.value = oParam[0];
        vccID.value = oParam[1];
        agentID.value = oParam[2];
        sipPort.value = oParam[3];
	    //3
		application.oJVccBar.OnCallRing = onOnCallRing;
		application.oJVccBar.AnswerCall = onOnAnswerCall;
		application.oJVccBar.OnCallEnd = onOnCallEnd;
		//18
		application.oJVccBar.OnPrompt = onOnPrompt;
		application.oJVccBar.OnReportBtnStatus = onReportBtnStatus;
		application.oJVccBar.OnInitalSuccess = onOnInitalSuccess;
		application.oJVccBar.OnInitalFailure = onOnInitalFailure;
		application.oJVccBar.OnEventPrompt = onOnEventPrompt;
		application.oJVccBar.OnAgentWorkReport = onOnAgentWorkReport;
		application.oJVccBar.OnCallDataChanged = onOnCallDataChanged;
		application.oJVccBar.OnBarExit = onOnBarExit;
	    application.oJVccBar.OnCallQueueQuery = onOnCallQueueQuery;
		application.oJVccBar.OnQueryGroupAgentStatus = onOnQueryGroupAgentStatus;
		application.oJVccBar.OnSystemMessage  = onOnSystemMessage;
		application.oJVccBar.OnRecvWeiboMsg = onOnRecvWeiboMsg;
		application.oJVccBar.OnIMMessage = onOnIMMessage
		application.oJVccBar.OnRecvWeChatMessage = onOnRecvWeChatMessage;
		application.oJVccBar.OnSendWeChatMsgReport = onOnSendWeChatMsgReport;
		application.oJVccBar.OnUploadFileToMMSReport = onOnUploadFileToMMSReport;
		application.oJVccBar.OnDownloadFileToMMSReport = onOnDownloadFileToMMSReport;
		application.oJVccBar.OnWorkStaticInfoReport = onOnWorkStaticInfoReport;
	

		
		application.oJVccBar.OnMethodResponseEvent = onOnMethodResponseEvent;
		
		displayCtrl();
		
        application.oJMonitor = new JMonitorCtrl(8,90,1200,540,application.GetRelationPath());
 	    application.BindMonitorBarToEachOther();
		//14	
		application.oJMonitor.OnAgentReport = onOnAgentReport;
		application.oJMonitor.OnTelReport = onOnTelReport;
		application.oJMonitor.OnServiceReport = onOnServiceReport;
		application.oJMonitor.OnIvrReport = onOnIvrReport;
		application.oJMonitor.OnTaskReport = onOnTaskReport;
		application.oJMonitor.OnOutboundReport = onOnOutboundReport;
		application.oJMonitor.OnCallReportInfo = onOnCallReportInfo;
		application.oJMonitor.OnQueueReport = onOnQueueReport;
		application.oJMonitor.OnQueryMonitorSumReport = onOnQueryMonitorSumReport;
		application.oJMonitor.OnWallServiceReport = onOnWallServiceReport;
		application.oJMonitor.OnWallQueueReport = onOnWallQueueReport;
		application.oJMonitor.OnServiceStaticReport = onOnServiceStaticReport;
		application.oJMonitor.OnAgentStaticReport = onOnAgentStaticReport;

 	    application.oJMonitor.OnMethodResponseEvent = function(key,param1){
            showLog("信息提示【OnMethodResponseEvent】：\r\n");
            showLog("         key       ：【"+key+"】\r\n");
            showLog("         vReturn   ：【"+param1+"】\r\n");
            showLog(" *******************************************************************\r\n");
 	        
 	    }
 	    application.oJMonitor.OnMonitorControlLoad = function () {
			application.oJMonitor.SetFunctionPage("0|1|2|3|4|5");
			//application.oJMonitor.SetFunctionPage("2|5");
 	    }
        displayM(_display);
	}
	
	function displayM(flag){//alert(application.oJMonitor.Show);
	    application.oJMonitor.Display(flag);
	    _display = flag;
	    if(_display == 0){
	        btnUnShow.disabled = true;
	        btnShow.disabled = false;
	        divInput.style.display = "block";
	        divMonitor.style.display = "block";
	        divTextInfo.style.top = "130px";
	        application.oJMonitor.SetAppMode(2);
	    }
	    else{
	        btnUnShow.disabled = false;
	        btnShow.disabled = true;
	        divInput.style.display = "none";
	        divMonitor.style.display = "none";
	        divTextInfo.style.top = "95px";
	        application.oJMonitor.SetAppMode(1);
	    }
	}
	function InitialMonitor()
	{
		application.oJMonitor.SetAppMode(1);
		var serverIP = document.getElementById("mainIP").value;
		var vccID = document.getElementById("vccID").value;
		var agentID = document.getElementById("agentID").value;
		// var serverIP = document.getElementById("mainIP").value;
		// var vccID = document.getElementById("vccID").value;
		// var agentID = document.getElementById("agentID").value;
		//application.oJMonitor.SetFunctionPage("0|1|2|3|4|5");
		//application.oJMonitor.Intial(serverIP, 4502, vccID, "000010" + vccID + agentID, "91550");
		application.oJMonitor.Intial(serverIP, 4502, vccID, "000010" + vccID + agentID, "111111");
		application.oJMonitor.SetWallBoardServer(serverIP, 14502);
	}
	function funInitial() 
	{
	    var  serverIP = document.getElementById("mainIP").value;
	    var  vccID = document.getElementById("vccID").value;
	    var  agentID  = document.getElementById("agentID").value;
	    var  sipPort = document.getElementById("sipPort").value;
        application.oJVccBar.SetAttribute("MainIP",serverIP);  //MainIP
        application.oJVccBar.SetAttribute("MainPortID",14800);  //MainPort
        application.oJVccBar.SetAttribute("BackIP",serverIP);  //BackIP
        application.oJVccBar.SetAttribute("BackPortID",14800);  //BackPort
        application.oJVccBar.SetAttribute("MonitorIP",serverIP);  //MonitorIP
        application.oJVccBar.SetAttribute("MonitorPort",4502);  //MainPort
        application.oJVccBar.SetAttribute("SipServerIP",serverIP);
        application.oJVccBar.SetAttribute("SipServerPort",parseInt(sipPort));
        application.oJVccBar.SetAttribute("SipProtocol","UDP");	
        application.oJVccBar.SetAttribute("PhonType",1);  //0:内置坐席卡；1：内置Sip；2：外置其他终端
        application.oJVccBar.SetAttribute("AgentType",1);
        application.oJVccBar.SetAttribute("SelfPrompt",0);
        application.oJVccBar.SetAttribute("MediaFlag",vccID);
        application.oJVccBar.SetAttribute("AppType",0);
        application.oJVccBar.SetAttribute("PassWord","111111");
        application.oJVccBar.SetAttribute("AgentID","000010"+vccID+agentID);
        application.oJVccBar.SetAttribute("Dn","000002"+vccID+agentID);
		application.oJVccBar.SetAttribute("SipPassWord", "00000000");
		application.oJVccBar.SetAttribute("SipAuthType", 1);
		application.oJVccBar.SetAttribute("VersionType",0); //0:企业版 1:教育版

        application.oJVccBar.SerialBtn("0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,19,20,21,22,30","7,8,10,11,12,13")

        application.oJVccBar.Initial();
        
	}

	
</script>