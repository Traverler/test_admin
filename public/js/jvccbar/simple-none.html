<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=gb2312">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>JS版本cinvccbar-全功能</title>    
	
	<script src="scripts/japp.js" type="text/javascript"></script>
	<script src="scripts/jbardisplay.js" type="text/javascript"></script>
	<script src="jbarextent.js" type="text/javascript"></script>
	
	<style> BODY { FONT-FAMILY: "Verdana"; FONT-SIZE: 12px; SCROLLBAR-HIGHLIGHT-COLOR: #f5f9ff; SCROLLBAR-SHADOW-COLOR: #828282; SCROLLBAR-3DLIGHT-COLOR: #828282; SCROLLBAR-ARROW-COLOR: #797979; SCROLLBAR-TRACK-COLOR: #ffffff; SCROLLBAR-FACE-COLOR: #66b7ef; SCROLLBAR-DARKSHADOW-COLOR: #ffffff }
	</style>
 </head>
<body onload="window_onload();" >
        <DIV style='position:absolute;border:0px solid #ff3900; left:10px;top:10px;'>
        服务器&nbsp;&nbsp;&nbsp;: <input type="text" id="mainIP" value="192.168.2.176"size="12"  /><br>
        集团号&nbsp;&nbsp;&nbsp;: <input type="text" id="vccID" size="12" value="100001"  /> <br>		
		工&nbsp;&nbsp;&nbsp;号&nbsp;&nbsp;&nbsp;: <input type="text" id="agentID" value="1006" size="12"  /><br>
		sip&nbsp;端口&nbsp;: <input type="text" id="sipPort" value="5066" size="12"  /><br>
		sip密码&nbsp;&nbsp;: <input type="text" id="sipPassword" value="00000000" size="12"  />
		</DIV>
		<DIV style='position:absolute;border:0px solid #000000; left:10px;top:122px;'>
		    目标参数:
		    <INPUT type="text" id="DestNum" NAME="DestNum" size="18" title="变量名称:DestNum"><br>
		    附加参数:
		    <INPUT type="text" id="DestNum2" NAME="DestNum2"  size="18"  title="变量名称:DestNum2">
		</DIV>
		<DIV style='position:absolute;border:0px solid #000000; left:217px;top:10px;'>	
               <input id='btncmd1' type="button" onclick='funChangePad(1);' style="background:#f5f9ff; border:0 " value="基本命令"/>
               <input id='btncmd2' type="button" onclick='funChangePad(2);' style="background:#f5f9ff; border:0 " value="基本状态"/>
               <input id='btncmd3' type="button" onclick='funChangePad(3);' style="background:#f5f9ff; border:0 " value="呼叫命令"/>
               <input id='btncmd4' type="button" onclick='funChangePad(4);' style="background:#f5f9ff; border:0 " value="质检命令"/>
               <input id='btncmd5' type="button" onclick='funChangePad(5);' style="background:#f5f9ff; border:0 " value="监控命令"/>
               <input id='btncmd6' type="button" onclick='funChangePad(6);' style="background:#f5f9ff; border:0 " value="扩展命令"/>
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               <SPAN id="agentTime" style="color: red;">座席状态时间</SPAN>
		</DIV>
	    <div id ="divPad1" style="position:absolute;border:0px solid #4A9DF9;left:217px;top:21px; display:none;"  >
                <br>
                <input id='btnInitial' type="button" onclick='funInitial();'  value="初始化" title="执行方法:Initial()" />
                <input id='btnUnInitial' type="button" onclick='application.oJVccBar.UnInitial();' value="注销" title="执行方法:UnInitial()" />
                <input id='btnSerialBtn' type="button" onclick='application.oJVccBar.SerialBtn(DestNum.value,DestNum2.value);' value="界面设置" title="执行方法:SerialBtn(DestNum,DestNum2) " />
                <input id='btnGetBtnStatus' type="button" onclick='application.oJVccBar.GetBtnStatus(DestNum.value);' value="可用电话按钮" title="执行方法:GetBtnStatus(DestNum) " />
                <br>
				<input id="btnConfigurate" onclick="application.oJVccBar.Configurate(DestNum.value);" type="button" value="设置参数" title="执行方法:Configurate(DestNum.value)">
				<input id="btnGetConfiguration" onclick="alert(application.oJVccBar.GetConfiguration());" type="button" value="得到参数" title="执行方法:GetConfiguration()">
                <input id='btnTrace' type="button" onclick='funtionTrace();' value="日志" title="显示座席日志" />
                <input id='btnSetUIStyle' type="button" onclick='application.oJVccBar.SetUIStyle(DestNum.value)();' value="样式" title="设置座席样式(ocx界面有用)" />
                <input id='btnGetVersion' type="button" onclick='alert(application.oJVccBar.GetVersion());' value="版本" title="执行:GetVersion(),得到版本号" />
                <br>
                <br>
		</div>	
	    <div id ="divPad2" style="position:absolute;border:0px solid #ff00ff;left:217px;top:21px; display:none;"  >
                <br>
			    <input id="btnSetBusy" onclick="application.oJVccBar.SetBusy(DestNum.value);" type="button" value="置忙" title="执行方法:SetBusy(DestNum.value)">
			    <input id="btnSetIdle" onclick="application.oJVccBar.SetIdle();" type="button" value="置闲"  title="执行方法:SetIdle()">
			    <input id="btnSetWrapUp" onclick="application.oJVccBar.SetWrapUp();" type="button" value="置后续态"  title="这个方法一直不可用!">
			    <input id="btnSetCTICalloutTask" onclick="application.oJVccBar.SetCTICalloutTask(DestNum.value);" type="button" value="设置外呼任务"  title="执行:SetCTICalloutTask(DestNum.value);">
			    <input id="btnGetCTICalloutTask" onclick="application.oJVccBar.GetCTICalloutTask();" type="button" value="得到外呼任务号"  title="执行:GetCTICalloutTask();">
			    <input id="btnGetCallData" onclick="application.oJVccBar.GetCallData(DestNum.value);" type="button" value="得到随路数据"  title="执行:GetCallData(DestNum.value);">
			    <input id="btnSetCallData" onclick="application.oJVccBar.SetCallData(DestNum.value,DestNum2.value);" type="button" value="设置随路数据"  title="执行:SetCallData(DestNum.value,DestNum2.value);">
			    <input id="btnGetTransfer" onclick="application.oJVccBar.GetTransfer();" type="button" value="得到前转信息"  title="执行:GetTransfer();">
			    <input id="btnSetTransfer" onclick="application.oJVccBar.SetTransfer(DestNum.value);" type="button" value="设置前转信息"  title="执行:SetTransfer(DestNum.value);">
			    <input id="btnChangeCallQueue" onclick="application.oJVccBar.ChangeCallQueue(DestNum.value,DestNum2.value,'000');" type="button" value="ChangeCallQueue"   title="执行:ChangeCallQueue(DestNum.value,DestNum2.value,'000');">
			    <input id="btnGetCallID" onclick="application.oJVccBar.GetCallID();" type="button" value="得到CallID"  title="执行:GetCallID();">
				<input id="btnQuerySPGroupList" onclick="application.oJVccBar.QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1);" type="button" value="QuerySPGroupList"  title="执行:QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1);">
				<input id="btnQuerySPGroupList1" onclick="application.oJVccBar.QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,0,5);" type="button" value="QuerySPGroupList Begin"  title="执行:QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,2,5);">
				<input id="btnQuerySPGroupList2" onclick="application.oJVccBar.QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,1,0);" type="button" value="QuerySPGroupList End"  title="执行:QuerySPGroupList(DestNum.value,-1,parseInt(DestNum2.value),1,1,0);">
			    <input id="btnGetCallInfo" onclick="application.oJVccBar.GetCallInfo();" type="button" value="得到呼叫信息"  title="执行:GetCallInfo();">
			    <input id="btnSetTransparentParameter" onclick="application.oJVccBar.SetTransparentParameter(DestNum.value);" type="button" value="设置透明参数"  title="执行:SetTransparentParameter(DestNum.value);">
				<input id="btnGetAgentStatus" onclick="alert(application.oJVccBar.GetAgentStatus());" type="button" value="得到座席状态"   title="执行:GetAgentStatus();">
				<input id="btnGetBusySubStatus" onclick="alert(application.oJVccBar.GetBusySubStatus());" type="button" value="得到忙碌子状态信息"   title="执行:GetBusySubStatus();">
			    <input id="btnSetDisplayNumber" onclick="application.oJVccBar.SetDisplayNumber(DestNum.value);" type="button" value="设置外呼显示号码"  title="执行:SetDisplayNumber(DestNum.value);">
			    <input id="btnGetDisplayNumber" onclick="application.oJVccBar.GetDisplayNumber();" type="button" value="得到外呼显示号码"  title="执行:GetDisplayNumber();">
				<input id="btnCallQueueQuery" onclick="application.oJVccBar.CallQueueQuery(DestNum.value);" type="button" value="查询排队信息"   title="执行:CallQueueQuery(DestNum.value);" >
				<input id="btnCallQueueQuery1" onclick="application.oJVccBar.CallQueueQuery(DestNum.value,0,5);" type="button" value="查询排队信息(开始)"   title="执行:CallQueueQuery(DestNum.value,2,5);" >
				<input id="btnCallQueueQuery2" onclick="application.oJVccBar.CallQueueQuery(DestNum.value,1,0);" type="button" value="查询排队信息(结束)"   title="执行:CallQueueQuery(DestNum.value,1,0);" >
				<input id="btnQueryGroupAgentStatus" onclick="application.oJVccBar.QueryGroupAgentStatus(DestNum.value,parseInt(DestNum2.value),10);" type="button" value="查询指定组的座席状态"  title="执行:QueryGroupAgentStatus(DestNum.value,parseInt(DestNum1.value),10);">
				<input id="btnQueryPreViewCallOutNumbers" onclick="application.oJVccBar.QueryPreViewCallOutNumbers(DestNum.value,DestNum2.value,50,1);" type="button" value="查询并分配预览外呼号码"  title="执行:QueryPreViewCallOutNumbers(DestNum.value,DestNum1.value,50,1);">
			    <input id="btnGetBase64Data" onclick="application.oJVccBar.GetBase64Data(DestNum.value);" type="button" value="base64编码"  title="执行:GetBase64Data(DestNum.value);">
			    <input id="btnGetDataFromBase64" onclick="application.oJVccBar.GetDataFromBase64(DestNum.value);" type="button" value="反base64编码"  title="执行:GetDataFromBase64(DestNum.value);">
			    <input id="btnSetWeChatQueueFlag" onclick="application.oJVccBar.SetWeChatQueueFlag(parseInt(DestNum.value));" type="button" value="设置微信参与排队"  title="执行:SetWeChatQueueFlag(parseInt(DestNum.value));">
			    <input id="btnGetWeChatQueueFlag" onclick="application.oJVccBar.GetWeChatQueueFlag();" type="button" value="得到微信参与排队"  title="执行:GetWeChatQueueFlag();">			    
			    <input id="btnTransferCallQueue" onclick="application.oJVccBar.TransferCallQueue(DestNum.value,0,DestNum2.value);" type="button" value="转接排队用户"   title="执行:TransferCallQueue(DestNum.value,0,DestNum2.value);">
			    <input id="btnSetActiveService" onclick="application.oJVccBar.SetActiveService(DestNum.value);" type="button" value="设置当前人工服务"  title="执行:SetActiveService(DestNum.value);">
			    <input id="btnGetActiveService" onclick="application.oJVccBar.GetActiveService();" type="button" value="当前座席人工服务集合"  title="执行:GetActiveService();">
				<input id="btnSetForwardNumber" onclick="application.oJVccBar.SetForwardNumber(DestNum.value,parseInt(DestNum2.value));" type="button" value="设置接续号码"  title="执行:SetForwardNumber(DestNum.value,parseInt(DestNum2.value));">
				<input id="btnGetForwardNumber" onclick="application.oJVccBar.GetForwardNumber();" type="button" value="得到接续号码"  title="执行:GetForwardNumber();">

		</div>	
	    <div id ="divPad3" style="position:absolute;border:0px solid #ff00ff;left:217px;top:21px; display:none;"  >
                <br>
				<input id="btnMakeCall" onclick="application.oJVccBar.MakeCall(DestNum.value,2,'','',DestNum2.value);" type="button" value="外呼" title="执行:MakeCall(DestNum.value,2,'','',DestNum2.value);" >
				<input id="btnCallIn" onclick="application.oJVccBar.CallIn(DestNum.value,5,'',DestNum2.value);" type="button" value="内呼" title="执行方法:CallIn(DestNum.value,5,"",DestNum2.value);" >
				<input id="btnTransferOut" onclick="application.oJVccBar.TransferOut(parseInt(DestNum2.value),DestNum.value);" type="button" value="转出"  title="执行:TransferOut(parseInt(DestNum2.value),DestNum.value)" >
				<input id="btnHold" onclick="application.oJVccBar.Hold();" type="button" value="保持" title="执行:Hold();" >
				<input id="btnRetrieveHold" onclick="application.oJVccBar.RetrieveHold();" type="button" value="取保持"   title="执行:RetrieveHold();" >
				<input id="btnDisconnect" onclick="application.oJVccBar.Disconnect(parseInt(DestNum.value));" type="button" value="挂断"   title="执行:Disconnect(parseInt(DestNum.value));" >
				<input id="btnAnswer" onclick="application.oJVccBar.Answer(parseInt(DestNum.value));" type="button" value="应答"   title="执行:Answer(parseInt(DestNum.value));" >
				<input id="btnConsult" onclick="application.oJVccBar.Consult(parseInt(DestNum2.value),DestNum.value);" type="button" value="咨询"   title="执行:Consult(parseInt(DestNum2.value),DestNum.value);" >
				<input id="btnTransfer" onclick="application.oJVccBar.Transfer();" type="button" value="转移"   title="执行:Transfer();" >
				<input id="btnConference" onclick="application.oJVccBar.Conference();" type="button" value="会议"   title="执行:Conference();" >
                <br>
				<input id="btnSendDTMF" onclick="application.oJVccBar.SendDTMF(DestNum.value);" type="button" value="二次拨号" title="执行方法:SendDTMF(DestNum.value);" >
				<input id="btnBeginRecord" onclick="application.oJVccBar.BeginRecord(DestNum.value,DestNum2.value);" type="button" value="开始录音"  title="执行:BeginRecord(DestNum.value,DestNum2.value); 【不使用】"  >
				<input id="btnStopRecord" onclick="application.oJVccBar.StopRecord(DestNum.value);" type="button" value="停止录音"  title="执行:StopRecord(DestNum.value); 【不使用】"  >
				<input id="btnBeginPlay" onclick="application.oJVccBar.BeginPlay(DestNum.value,'',2,'message.wav','1');" type="button" value="推送视频"  title="执行:BeginPlay(DestNum.value,'',2,'message.wav','1');"  >
				<input id="btnStopPlay" onclick="application.oJVccBar.StopPlay(DestNum.value,'');" type="button" value="停止推送"  title="执行:StopPlay(DestNum.value,'');"  >
				<input id="btnBridge" onclick="application.oJVccBar.Bridge(DestNum.value,parseInt(DestNum2.value));" type="button" value="桥接"  title="执行:Bridge(DestNum.value,parseInt(DestNum2.value));"  >
				<input id="btnMute" onclick="application.oJVccBar.Mute(parseInt(DestNum.value));" type="button" value="静音"   title="执行:Mute(parseInt(DestNum.value));" >
				<input id="btnAlterNate" onclick="application.oJVccBar.AlterNate(DestNum.value);" type="button" value="电话切换" title="执行方法:AlterNate(DestNum.value);" >
                <br>
				<input id="btnCallBack" onclick="application.oJVccBar.CallBack();" type="button" value="回拨" title="执行:CallBack();" >
				<input id="btnReCall" onclick="application.oJVccBar.ReCall();" type="button" value="重拨"   title="执行:ReCall();" >
				<input id="btnSMMsg" onclick="application.oJVccBar.SMMsg(DestNum.value,DestNum2.value);" type="button" value="发短信"  title="执行:SMMsg(DestNum.value,DestNum2.value);"  >
				<input id="btnReleaseThirdOne" onclick="application.oJVccBar.ReleaseThirdOne(parseInt(DestNum.value));" type="button" value="挂断第三方"   title="执行:ReleaseThirdOne(parseInt(DestNum.value));" >
				<INPUT id="btnBeginCollect" onclick="application.oJVccBar.BeginCollect(DestNum.value,DestNum2.value,0,'',1,1,'','',20,10);" type="button" value="开始收号" title="执行:BeginCollect(DestNum.value,DestNum2.value,0,'',1,1,'','',20,10);" >
				<INPUT id="btnStopCollect" onclick="application.oJVccBar.StopCollect(DestNum.value,DestNum2.value);" type="button" value="停止收号"  title="执行:StopCollect(DestNum.value,DestNum2.value);" >
				<input id="btnFroceReset" onclick="application.oJVccBar.ForceReset();" type="button" value="强复位"  title="执行方法:FroceReset()">
				<input id="btnSendIMMessage" onclick="application.oJVccBar.SendIMMessage( '','','',1,0,DestNum.value);" type="button" value="发送即时消息"  title="执行方法:SendIMMessage( '','','',1,0,DestNum.value);">
		</div>	
	    <div id ="divPad4" style="position:absolute;border:0px solid #ff00ff;left:217px;top:21px; display:none;"  >
                <br>
 				<input id="btnForceClear" onclick="application.oJVccBar.ForeReleaseCall(DestNum.value);" type="button" value="强拆"  title="执行方法:ForeReleaseCall(DestNum.value)" >
				<input id="btnInsert" onclick="application.oJVccBar.Insert(DestNum.value);" type="button" value="强插" title="执行方法:Insert(DestNum.value)" >
				<input id="btnListen" onclick="application.oJVccBar.Listen(DestNum.value);" type="button" value="监听" title="执行方法:Listen(DestNum.value)" >
				<input id="btnIntercept" onclick="application.oJVccBar.Intercept(DestNum.value);" type="button" value="拦截" title="执行方法:Intercept(DestNum.value)" >
				<input id="btnHelp" onclick="application.oJVccBar.Help(DestNum.value);" type="button" value="辅助"  title="执行方法:Help(DestNum.value)" >
		        <input id="btnForceIdle" onclick="application.oJVccBar.ForceIdle(DestNum.value);" type="button" value="强制置闲" title="执行方法:ForceIdle(DestNum.value)">
                <br>
				<input id="btnForceBusy" onclick="application.oJVccBar.ForceBusy(DestNum.value);" type="button" value="强制置忙"  title="执行方法:ForceBusy(DestNum.value)">
				<input id="btnForceOut" onclick="application.oJVccBar.ForceOut(DestNum.value);" type="button" value="强制签出"  title="执行方法:ForceOut(DestNum.value)">
				<input id="btnLock" onclick="application.oJVccBar.Lock(DestNum.value);" type="button" value="锁定"  title="执行方法:Lock(DestNum.value);【不用，系统自己锁定】">
				<input id="btnUnLock" onclick="application.oJVccBar.UnLock(DestNum.value);" type="button" value="解锁"  title="执行方法:UnLock(DestNum.value)">
		</div>	
	    <div id ="divPad5" style="position:absolute;border:0px solid #ff00ff;left:217px;top:21px; display:none;"  >
                <br>
 				<input id="btnInitialState" onclick="application.oJVccBar.InitialState();" type="button" value="InitialState"  title="执行方法:InitialState();" >
				<input id="btnAgentQuery" onclick="application.oJVccBar.AgentQuery(DestNum.value,parseInt(DestNum2.value));" type="button" value="AgentQuery"  title="执行方法:AgentQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnTelQuery" onclick="application.oJVccBar.TelQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="TelQuery" title="执行方法:TelQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnIvrQuery" onclick="application.oJVccBar.IvrQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="IvrQuery" title="执行方法:IvrQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnServiceQuery" onclick="application.oJVccBar.ServiceQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="ServiceQuery" title="执行方法:ServiceQuery(DestNum.value,parseInt(DestNum2.value));" >
                <br>
				<input id="btnTaskQuery" onclick="application.oJVccBar.TaskQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="TaskQuery" title="执行方法:TaskQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnCallReportQuery" onclick="application.oJVccBar.CallReportQuery(DestNum.value,parseInt(DestNum2.value));" type="button"  value="CallReportQuery" title="执行方法:CallReportQuery(DestNum.value,parseInt(DestNum2.value));" >
				<input id="btnGetTaskSummary" onclick="application.oJVccBar.GetTaskSummary(DestNum.value,DestNum2.value);" type="button"  value="GetTaskSummary" title="执行方法:GetTaskSummary(DestNum.value,DestNum2.value);" >
                <br>
				<input id="btnQueryMonitorSumInfo" onclick="application.oJVccBar.QueryMonitorSumInfo(DestNum.value,DestNum2.value);" type="button" value="查询指定参数的统计信息" title="执行:QueryMonitorSumInfo(DestNum.value,DestNum2.value);" >
				<input id="btnStartNotification" onclick="application.oJVccBar.StartNotification(DestNum.value,DestNum2.value,'');" type="button" value="StartNotification"  title="执行方法:StartNotification(DestNum.value,DestNum2.value,'');" >
				<input id="btnEndNotification" onclick="application.oJVccBar.EndNotification(DestNum.value);" type="button" value="EndNotification" title="执行方法:EndNotification(DestNum.value);" >
	            <br>
		</div>	
	    <div id ="divPad6" style="position:absolute;border:0px solid #ff00ff;left:217px;top:21px; display:none;"  >
                <br>
 				<input id="btnSendWeiboMsg" onclick="application.oJVccBar.SendWeiboMsg(DestNum.value);" type="button" value="发微博消息" title="【暂时不可用】" >
				<input id="btnUploadFileToMMS" onclick="application.oJVccBar.UploadFileToMMS(DestNum.value,0);" type="button" value="UploadFileToMMS" title="执行:UploadFileToMMS" >
				<input id="btnDownFileFromMMS" onclick="application.oJVccBar.DownFileFromMMS(DestNum.value,DestNum2.value,'');" type="button" value="DownFileFromMMS" title="执行:DownFileFromMMS" >
                <br>
				<input id="btnSendWeChatMsg" onclick="application.oJVccBar.SendWeChatMsg(DestNum.value);" type="button" value="SendWeChatMsg" title="执行:SendWeChatMsg"  >
				<input id="btnQueryWeChatData" onclick="application.oJVccBar.QueryWeChatData(DestNum.value);" type="button" value="QueryWeChatData"  title="执行: QueryWeChatData" >
				<input id="btnQueryWeChatHistory" onclick="application.oJVccBar.QueryWeChatHistory(DestNum.value);" type="button" value="QueryWeChatHistory"  title="执行: QueryWeChatHistory" >
				<input id="btnGetWeChatParam" onclick="application.oJVccBar.GetWeChatParam(DestNum.value);" type="button" value="GetWeChatParam"  title="执行: GetWeChatParam" >
	        <br>
		</div>	
        <DIV style='position:absolute;border:0px solid #00ff00; left:10px;top:170px;'>	
		<TEXTAREA id="TextareaInfo" name="TextareaInfo" rows="32" cols="160" value="" style="overflow:auto;font-family:verdana;font-size:12px"></TEXTAREA>
		</DIV>

</body>
   <script type="text/javascript">
    var g_showIndex = 1;
    function funChangePad(index)
    {  
        var oPad = document.getElementById("divPad"+g_showIndex);
        oPad.style.display = "none";
        
        var oBtn = document.getElementById("btncmd"+g_showIndex);
        oBtn.style.background = "#f5f9ff";
        
        oPad = document.getElementById("divPad"+index);
        oPad.style.display = "block";
        oBtn = document.getElementById("btncmd"+index);
        oBtn.style.background = "#80BEC4";
        
        g_showIndex = index;
    }
   	function funInitial() 
	{
	    var  serverIP = document.getElementById("mainIP").value;
	    var  vccID = document.getElementById("vccID").value;
	    var  agentID  = document.getElementById("agentID").value;
	    var  sipPort = document.getElementById("sipPort").value;
		var  sipPassword = document.getElementById("sipPassword").value;

        application.oJVccBar.SetAttribute("MainIP",serverIP);  //MainIP
        application.oJVccBar.SetAttribute("MainPortID",14800);  //MainPort
        application.oJVccBar.SetAttribute("BackIP",serverIP);  //BackIP
        application.oJVccBar.SetAttribute("BackPortID",14800);  //BackPort
        application.oJVccBar.SetAttribute("MonitorIP",serverIP);  //MonitorIP
        application.oJVccBar.SetAttribute("MonitorPort",4502);  //MainPort
        application.oJVccBar.SetAttribute("SipServerIP",serverIP);
        application.oJVccBar.SetAttribute("SipServerPort",parseInt(sipPort));
        application.oJVccBar.SetAttribute("SipProtocol","UDP");	
        application.oJVccBar.SetAttribute("PhonType",1);  //0:内置坐席卡；1：内置Sip；2：外置其他终端
        application.oJVccBar.SetAttribute("AgentType",1);
        application.oJVccBar.SetAttribute("SelfPrompt",1);
        application.oJVccBar.SetAttribute("MediaFlag",vccID);
        application.oJVccBar.SetAttribute("AppType",2);
        application.oJVccBar.SetAttribute("PassWord","111111");
        application.oJVccBar.SetAttribute("AgentID","000010"+vccID+agentID);
        application.oJVccBar.SetAttribute("Dn", "000002" + vccID + agentID);
        application.oJVccBar.SetAttribute("SipPassWord", sipPassword);
        application.oJVccBar.Initial();
		
	}    

	function window_onload()
	{
	    if(document.readyState=="complete")
	    {
	        funChangePad(1);
	    }
	    applicationLoad(0,0,200,50,showStyleNONE,"",OnAfterVccBarCreate);	       
	}
	
	//创建对象成功，绑定电话条事件
	function OnAfterVccBarCreate()
	{ 
	    //3
		application.oJVccBar.OnCallRing = onOnCallRing;
		application.oJVccBar.AnswerCall = onOnAnswerCall;
		application.oJVccBar.OnCallEnd = onOnCallEnd;
		//18
		application.oJVccBar.OnPrompt = onOnPrompt;
		application.oJVccBar.OnReportBtnStatus = onReportBtnStatus;
		application.oJVccBar.OnInitalSuccess = onOnInitalSuccess;
		application.oJVccBar.OnInitalFailure = onOnInitalFailure;
		application.oJVccBar.OnEventPrompt = onOnEventPrompt;
		application.oJVccBar.OnAgentWorkReport = onOnAgentWorkReport;
		application.oJVccBar.OnCallDataChanged = onOnCallDataChanged;
		application.oJVccBar.OnBarExit = onOnBarExit;
	    application.oJVccBar.OnCallQueueQuery = onOnCallQueueQuery;
		application.oJVccBar.OnQueryGroupAgentStatus = onOnQueryGroupAgentStatus;
		application.oJVccBar.OnSystemMessage  = onOnSystemMessage;
		application.oJVccBar.OnRecvWeiboMsg = onOnRecvWeiboMsg;
		application.oJVccBar.OnIMMessage = onOnIMMessage
		application.oJVccBar.OnRecvWeChatMessage = onOnRecvWeChatMessage;
		application.oJVccBar.OnSendWeChatMsgReport = onOnSendWeChatMsgReport;
		application.oJVccBar.OnUploadFileToMMSReport = onOnUploadFileToMMSReport;
		application.oJVccBar.OnDownloadFileToMMSReport = onOnDownloadFileToMMSReport;
		application.oJVccBar.OnWorkStaticInfoReport = onOnWorkStaticInfoReport;
	
		//14	
		application.oJVccBar.OnAgentReport = onOnAgentReport;
		application.oJVccBar.OnTelReport = onOnTelReport;
		application.oJVccBar.OnServiceReport = onOnServiceReport;
		application.oJVccBar.OnIvrReport = onOnIvrReport;
		application.oJVccBar.OnTaskReport = onOnTaskReport;
		application.oJVccBar.OnOutboundReport = onOnOutboundReport;
		application.oJVccBar.OnCallReportInfo = onOnCallReportInfo;
		application.oJVccBar.OnQueueReport = onOnQueueReport;
		application.oJVccBar.OnQueryMonitorSumReport = onOnQueryMonitorSumReport;
		application.oJVccBar.OnWallServiceReport = onOnWallServiceReport;
		application.oJVccBar.OnWallQueueReport = onOnWallQueueReport;
		application.oJVccBar.OnServiceStaticReport = onOnServiceStaticReport;
		application.oJVccBar.OnAgentStaticReport = onOnAgentStaticReport;
		application.oJVccBar.OnMethodResponseEvent = onOnMethodResponseEvent;
		
       // application.oJVccBar.SetAttribute("AutoUpdateURL","http://192.168.2.136:8080/cin-dcp/BarUpdate");  //AutoUpdateURL

		//application.oVccBarAssist.oBarBtnControl.SetUpdateType(1);
		
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnSetBusy",1);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnSetIdle",2);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnMakeCall",3);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnCallIn",3);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnHold",4);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnRetrieveHold",5);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnDisconnect",6);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnTransfer",7);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnConference",8);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnAnswer",9);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnTransferOut",10);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnConsult",11);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnSendDTMF",12);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnBridge",13);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnAlterNate",14);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnConfigurate",15);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnFroceReset",16);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnBeginRecord",17);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnStopRecord",18);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnListen",19);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnInsert",20);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnIntercept",21);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnForeReleaseCall",22);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnBeginPlay",23);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnStopPlay",24);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnLock",25);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnUnLock",26);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnMute",27);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnCallBack",28);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnReCall",29);
	    application.oVccBarAssist.oBarBtnControl.AttachBtnByUIID("btnHelp",30);
		
		if(application.oVccBarAssist.oBarAgentStatus != null)
		{
		    application.oVccBarAssist.oBarAgentStatus.OnAgentStatusTime = function(agentStatus,agentStatusText,timerCount){
	            if(agentTime != null)
	                agentTime.innerHTML  = "【"+agentStatusText+"】:【"+timerCount+"】";		    
		    }
		 }

		displayCtrl();
	}
	
   var digLog = null;
   function funtionTrace(){
	    digLog = new divDialog(parseInt(event.clientX),parseInt(event.clientY),260,180,1,0,null);
		var shtml = "<p>&nbsp;&nbsp;日志级别:";
		shtml = shtml + "<select id='oLogSel' name='styles'>"
		shtml = shtml + 	"<option value=0 selected>不显示日志"
		shtml = shtml + 	"<option value=1 >致命错误"
		shtml = shtml + 	"<option value=2 >警告信息"
		shtml = shtml + 	"<option value=3 >调试信息"
		shtml = shtml + 	"<option value=4 >提示消息"
		shtml = shtml + 	"<option value=5 >协议信息"
		shtml = shtml + 	"<option value=6 >所有信息"
		shtml = shtml + 	"</select></p>"
		shtml = shtml + 	"<p align='center'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id='ok' onclick='OnSettingLog();' type='button' value='设置' ><input id='cancel' onclick='digLog.eCloseDiv();' type='button' value='取消' ></p>";	
		digLog.setSetContent(shtml);	
		digLog.setTitle("日志设置");    
	    digLog.show(1);
   
   }
   function OnSettingLog(){
        var oSelType = document.getElementById("oLogSel");
        var callType = oSelType.options[oSelType.options.selectedIndex].value;
        gLogType = callType;
        if(gLogType>VccBar_Log_None){
            application.DislayLog(1);
        }
        else{
            application.DislayLog(0);
        }
        digLog.eCloseDiv();
        
   }

    </script>

</html>

