<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=gb2312">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>简单</title>
    <script src="scripts/japp.js" type="text/javascript"></script>
    <script src="jbarextent.js" type="text/javascript"></script>

	<style> BODY { FONT-FAMILY: "Verdana"; FONT-SIZE: 12px; SCROLLBAR-HIGHLIGHT-COLOR: #f5f9ff; SCROLLBAR-SHADOW-COLOR: #828282; SCROLLBAR-3DLIGHT-COLOR: #828282; SCROLLBAR-ARROW-COLOR: #797979; SCROLLBAR-TRACK-COLOR: #ffffff; SCROLLBAR-FACE-COLOR: #66b7ef; SCROLLBAR-DARKSHADOW-COLOR: #ffffff }
	</style>

</head>
<body onload="window_onload();">
       <DIV style='position:absolute;border:0px solid #ff3900; left:10px;top:54px;'>
        &nbsp;服务器: <input type="text" id="mainIP" value="192.168.2.136"size="12"  />
        集团号: <input type="text" id="vccID" size="12" value="100004"  /> 		
		工号: <input type="text" id="agentID" value="6301" size="12"  />
		sip端口: <input type="text" id="sipPort" value="5060" size="12"  />
        sip密码&nbsp;&nbsp;: <input type="text" id="sipPassword" value="00000000" size="12"  />
        <input id='btnInitial' type="button" onclick='funInitial();'  value="初始化" title="执行方法:Initial()" />
        <input id='btnUnInitial' type="button" onclick='application.oJVccBar.UnInitial();' value="注销" title="执行方法:UnInitial()" />
        <input id='btnTest' type="button" onclick='funMakeCall();'  value="页面测试" title="执行方法:Initial()" />
		</DIV>
        <DIV style='position:absolute;border:0px solid #00ff00; left:10px;top:90px;'>	
		<TEXTAREA id="TextareaInfo" name="TextareaInfo" rows="34" cols="160" value="" style="overflow:auto;font-family:verdana;font-size:12px"></TEXTAREA>
		</DIV>

</body>
</html>
 <script type="text/javascript">   
	function window_onload()
	{
		    var param = "192.168.2.176|100001|1001|5066";
            param = "192.168.2.136|100005|6602|5066";
            param = "221.238.152.206|777777|3001|5040";
	        var oParam = param.split("|");
	        mainIP.value = oParam[0];
	        vccID.value = oParam[1];
	        agentID.value = oParam[2];
	        sipPort.value = oParam[3];
         applicationLoad(10,10,960,36,showStyleJS,"",setVccBarEvent);
	}
	
	function funInitial() 
	{
	    var  serverIP = document.getElementById("mainIP").value;
	    var  vccID = document.getElementById("vccID").value;
	    var  agentID  = document.getElementById("agentID").value;
	    var  sipPort = document.getElementById("sipPort").value;
        var  sipPassword = document.getElementById("sipPassword").value;
        application.oJVccBar.SetAttribute("MainIP",serverIP);  //MainIP
        application.oJVccBar.SetAttribute("MainPortID",14800);  //MainPort
        application.oJVccBar.SetAttribute("BackIP",serverIP);  //BackIP
        application.oJVccBar.SetAttribute("BackPortID",14800);  //BackPort
        application.oJVccBar.SetAttribute("MonitorIP",serverIP);  //MonitorIP
        application.oJVccBar.SetAttribute("MonitorPort",4502);  //MainPort
        application.oJVccBar.SetAttribute("SipServerIP",serverIP);
        application.oJVccBar.SetAttribute("SipServerPort",parseInt(sipPort));
        application.oJVccBar.SetAttribute("SipProtocol","UDP");	
        application.oJVccBar.SetAttribute("PhonType",2);  //0:内置坐席卡；1：内置Sip；2：外置其他终端
        application.oJVccBar.SetAttribute("AgentType",1);
        application.oJVccBar.SetAttribute("SelfPrompt",1);
        application.oJVccBar.SetAttribute("MediaFlag",vccID);
        application.oJVccBar.SetAttribute("AppType",0);
        application.oJVccBar.SetAttribute("PassWord","111111");
        application.oJVccBar.SetAttribute("AgentID","000010"+vccID+agentID);
        application.oJVccBar.SetAttribute("Dn","000002"+vccID+agentID);
        application.oJVccBar.SetAttribute("SipPassWord", sipPassword);
        application.oJVccBar.SerialBtn("0,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16","11,12,13");
        application.oJVccBar.Initial();


    }
    var oMakeCallDlg = null;
    function funMakeCall() 
    {
        window.showModelessDialog(
			"makecall.htm",
			window,
			"dialogHeight: 360px; dialogWidth: 397px;edge: Raised; help: Yes; resizable: no;status:no;scroll:no; ");
    }


 </script>